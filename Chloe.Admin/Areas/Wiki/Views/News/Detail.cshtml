@{
    ViewData["Title"] = "详细内容";
    List<Ace.Entity.Wiki.Sort> ListSort = ViewBag.ListSort as List<Ace.Entity.Wiki.Sort>;
    Ace.Entity.Wiki.News NewsModle = ViewBag.NewsModle as Ace.Entity.Wiki.News;
}

@this.RefStyle("~/Content/webuploader/webuploader.css")
@this.RefScript("~/Content/webuploader/webuploader.js")
<style type="text/css">
    #picker {
        line-height: 20px;
        vertical-align: middle;
        margin: 0 0px 0 0;
    }
</style>

<div class="container">
    <div class="row">
        <form class="form-horizontal col-md-12" method="post" action="/Wiki/News/Edit">
            <fieldset>
                <div id="legend" class="">
                    <legend class="">详细内容</legend>
                </div>

                <input type="hidden" class="form-control" value="@NewsModle.Id" id="Id" name="Id">
                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon1">新闻标题</span>
                        <div class="form-control">@NewsModle.Title</div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon2">新闻分类</span>
                        <select class="form-control" id="SortID" name="SortID">
                            @foreach (var item in ListSort)
                            {
                                if (NewsModle.SortID == item.Id)
                                {
                            <option selected value="@item.Id">@item.Title</option>
                                }
                                else
                                {
                            <option value="@item.Id">@item.Title</option>
                                }

                            }

                        </select>

                    </div>
                </div>

                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon">图片上传</span>
                        <div class="form-control">@NewsModle.ImageUrl</div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon3">新闻链接</span>
                        <div class="form-control">@NewsModle.LinkUrl</div>
                    </div>
                </div>

                <div class="form-group">
                    <div class="input-group">
                        <span class="input-group-addon" id="basic-addon4">新闻摘要</span>
                        <div class="form-control">@NewsModle.Summary</div>
                    </div>
                </div>



                <div class="form-group">
                    <label for="inputfile">内容</label>
                    <div style="width:100%;height:300px;">
                        @Html.Raw(NewsModle.Contents)
                    </div>
                </div>



            </fieldset>
        </form>

    </div>



</div>
<script>
    KindEditor.ready(function (K) {
        window.editor = K.create('#Contents', {
            uploadJson: '/KindEditor/SaveFiles',
            fileManagerJson: '/KindEditor/FileManager',
            allowFileManager: true
        });
    });

    var uploader = WebUploader.create({
        auto: true,
        swf: '/Content/webuploader/Uploader.swf',
        server: '/KindEditor/SaveFiles',
        pick: '#picker',
        resize: false
    });

    uploader.on('uploadSuccess', function (file, response) {
        var json = jQuery.parseJSON(response._raw);
        if (response.error == '0') {
            $("#ImageUrl").val(response.url);

        }
        else {
            var msg = "上传失败，文件数据无法正确解析";
            $ace.alert(msg);
        }
    });
</script>


